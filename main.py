# Script that searches the NIST National Vulnerability Database for the given Vendors/Services
# and returns new CVEs for those services(if any) in the format of an email every X amount of hours
# This product uses the NVD API but is not endorsed or certified by the NVD

# TO DO:
# Add Senior Project Attribution
# Add CPE usage capabilities
# 
import configparser
import search

config = configparser.ConfigParser()
config.read('config.ini')

def startUp():
    try:
        if config.getboolean('DEFAULT', 'isCPE') == True and config.getboolean('DEFAULT', 'isKeywordSearch') == False:
            #Filler
            print("CPE Search Working! Exiting")
            exit(0)
        
        elif config.getboolean('DEFAULT', 'isCPE') == False and config.getboolean('DEFAULT', 'isKeywordSearch') == True:
            search.single_search()
            print("CVE-Emailer started.")
            
        else:
            print("Something is very wrong! Exiting")
            exit(0)    
            
    except KeyboardInterrupt:
        exit(0)
        
def main():
    print('Starting program')

if __name__ == "__main__":
    startUp()