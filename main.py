# Script that searches the NIST National Vulnerability Database for the given Vendors/Services
# and returns new CVEs for those services(if any) in the format of an email every X amount of hours
# This product uses the NVD API but is not endorsed or certified by the NVD

# TO DO:
# Add 5 second sleep timer between each search
# Develop and test SQL features
# Add CPE usage capabilities
# 
import mysql.connector
import configparser
from email.mime.text import MIMEText
import search
import database
import datetime

config = configparser.ConfigParser()
config.read('config.ini')

def startUp():
    print('Starting program')
    try:
        if config.getboolean('DEFAULT', 'isCPE') == True and config.getboolean('DEFAULT', 'isKeywordSearch') == False:
                
            #Filler
            print("CPE Search Working! Exiting")
            exit(0)
        
        elif config.getboolean('DEFAULT', 'isCPE') == False and config.getboolean('DEFAULT', 'isKeywordSearch') == True:

            search.singleSearch()
        else:
            print("Something is very wrong! Exiting")
            exit(0)    
            
    except KeyboardInterrupt:
        exit(0)
        
def main():
    currentTime = datetime.datetime.now()
    print(currentTime)
    #email = mail.createEmail(config['EMAIL']['senderEmail'], config['EMAIL']['recipientEmail'], config['EMAIL']['subjectLine'], # UNCOMMENT TO CREATE EMAIL
    #                      singleSearch(config['DEFAULT']['apiURL']))
    #mail.sendEmail(config['EMAIL']['senderEmail'], config['EMAIL']['senderPassword'], email) # UNCOMMENT TO SEND EMAIL


if __name__ == "__main__":
    startUp()