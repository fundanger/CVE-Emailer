import mysql.connector

def connectDB(username, password, host, database): # Connects to the DB
    connection = None
    try:
        connection = mysql.connector.connect( # initiate connection
            user = username, 
            password = password, 
            host = host, 
            database = database) # DB connection
        connection.cursor()
        print("Connected to Database!")
    except mysql.connector.Error as error:
        print("Failed to connect to MySQL database:" , error)
    finally:
        print("connection closing")
        connection.close()

def populateDB(username, password, host, database, serviceName): # Connects to the DB
    try:
        connection = mysql.connector.connect( # initiate connection
            user = username, 
            password = password, 
            host = host, 
            database = database) # DB connection
        connection.cursor()
        print("Connected to Database!")
        createTable(serviceName) 
    except mysql.connector.Error as error:
        print("Failed to connect to MySQL database:" , error)
    finally:
        print("connection closing")
        connection.close()
        
def createTables(username, password, host, database, service_name):
    try:
        print("Creating table for " + str(service_name))
        connection = mysql.connector.connect( # initiate connection
            user = username, 
            password = password, 
            host = host, 
            database = database) # DB connection
        cursor = connection.cursor()
        print("Connected to Database!")
        tableQuery = ("CREATE TABLE IF NOT EXISTS " + service_name +
                      """(id INT(10) AUTO_INCREMENT PRIMARY KEY,
                      cve_id VARCHAR(255) NOT NULL,                   
                      publish_date DATE FORMAT 'MM/DD/YYYY',
                      last_modified DATE FORMAT 'MM/DD/YYYY',
                      description TEXT);""")
        cursor.execute(tableQuery)
        
    except mysql.connector.Error as error:
        print("Failed to connect to MySQL database:" , error)
    finally:
        print("connection closing")
        connection.close()
    

def insertData(service_name, CVE, publish_date, last_modified, description):
    insertQuery = "INSERT INTO "
    + service_name
    + " (cve_id, publish_date, last_modified, description)"
    + " VALUES" 
    + (CVE, publish_date, last_modified, description)
    + ";"
    

    
    
