import mysql.connector


def connectDB(username, password, localhost, databaseName): # Connects to the DB
    try:
        connection = mysql.connector.connect(user = username, password = password, host = localhost, database = databaseName) # DB connection
        return connection
    except mysql.connector.Error as error:
        print("There was an error connecting to the database, closing the connection.")
        print(error)
        connection.close()
        
    
def createCursor(connection):
    cursor = connection.cursor()
    return cursor
        
def createTable (serviceName):
    tableQuery = ("CREATE TABLE " + serviceName +
                   """(id INT(10) NOT NULL AUTO_INCREMENT,
                   cve_id VARCHAR(255) NOT NULL,                   
                   publish_date DATE FORMAT 'MM/DD/YYYY',
                   last_modified DATE FORMAT 'MM/DD/YYYY',
                   description TEXT)""")
    

def closeConnections(connection, cursor):
    connection.close()
    cursor.close()
    
    
