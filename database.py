import mysql.connector


def connectDB(username, password, localhost, databaseName): # Connects to the DB
    connection = None
    try:
        connection = mysql.connector.connect(user = username, password = password, host = localhost, database = databaseName) # DB connection
        return connection
    except mysql.connector.Error as error:
        print("There was an error connecting to the database, closing the connection.")
        print(error)
    finally:
         if connection is not None:
              connection.close()
        
    
def createCursor(connection):
    cursor = connection.cursor()
    return cursor


def createTable (service_name):
    tableQuery = ("CREATE TABLE " + service_name +
                   """(id INT(10) AUTO_INCREMENT PRIMARY KEY,
                   cve_id VARCHAR(255) NOT NULL,                   
                   publish_date DATE FORMAT 'MM/DD/YYYY',
                   last_modified DATE FORMAT 'MM/DD/YYYY',
                   description TEXT);""")

def insertData(service_name, CVE, publish_date, last_modified, description):
        insertQuery = "INSERT INTO "
        + service_name
        + " (cve_id, publish_date, last_modified, description)"
        + " VALUES" + (CVE, publish_date, last_modified, description)
        + ";"

def closeConnections(connection, cursor):
    connection.close()
    cursor.close()
    
    
