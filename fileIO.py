import search
import database
import configparser

config = configparser.ConfigParser()
config.read('config.ini')

connection_config = {
    'user': config['DATABASE']['username'], 
    'password': config['DATABASE']['password'], 
    'host': config['DATABASE']['host'], 
    'database': config['DATABASE']['database']
}

def readFile(file):
    try:
        with open(file, 'r') as file:
            for line in file:
                formatted_line = line.replace(" ", "")
                database.createTables(
                    config['DATABASE']['username'],
                    config['DATABASE']['password'],
                    config['DATABASE']['host'],
                    config['DATABASE']['database'],
                    formatted_line)
        file.close()
    except FileNotFoundError:
        print("There was a problem opening the file, exiting")
        exit(0)

def retrieve_service_names(file):
    try:
        with open(file, 'r') as file:
            for line in file:
                formatted_line = line.replace(" ", "")

        file.close()
    except FileNotFoundError:
        print("There was a problem opening the file, exiting")
        exit(0)
        
def makeKeywordURL(keywords):
    URL = 'https://services.nvd.nist.gov/rest/json/cves/2.0?keywordSearch=' + keywords
    URL = URL.replace(" ", "%20")
    return URL